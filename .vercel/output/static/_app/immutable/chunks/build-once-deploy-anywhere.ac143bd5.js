import{S as Ho,i as xo,s as Mo,k as a,a as u,r as l,l as o,m as s,h as t,c as f,u as r,W as _o,p as c,b as p,M as n,n as ka}from"./index.26320ab0.js";function jo(Ao){let b,se,wa,$e,E,Bt,O,Zt,Gt,et,ie,Ut,tt,D,qt,L,me,nt,pe,Ft,at,W,Kt,H,ye,ot,_,Qt,x,Vt,Xt,st,M,Yt,j,ge,it,le,$t,pt,k,be,Ee,en,tn,_e,Ae,nn,an,Ie,Pe,on,sn,Ce,Te,pn,lt,re,Se,ln,rt,R,rn,J,Ne,ct,ce,cn,ut,z,Io=`<code class="language-typescript"><span class="token punctuation">&#123;</span>
    <span class="token string-property property">"api"</span> <span class="token operator">:</span> <span class="token string">"http://localhost:5000/"</span>
<span class="token punctuation">&#125;</span></code>`,ft,B,un,Z,Oe,dt,v,fn,De,dn,hn,Le,kn,wn,ht,ue,fe,va,kt,G,vn,U,We,wt,de,mn,vt,q,Po=`<code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Injectable</span></span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  providedIn<span class="token operator">:</span> <span class="token string">'root'</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">ConfigService</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">private</span> configuration<span class="token operator">:</span> AppConfig

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> httpClient<span class="token operator">:</span> HttpClient<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

  <span class="token function">setConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token builtin">Promise</span><span class="token operator">&lt;</span>AppConfig<span class="token operator">></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>httpClient
      <span class="token punctuation">.</span><span class="token generic-function"><span class="token function">get</span><span class="token generic class-name"><span class="token operator">&lt;</span>AppConfig<span class="token operator">></span></span></span><span class="token punctuation">(</span><span class="token string">'./app-config.json'</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">toPromise</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
      <span class="token punctuation">.</span><span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">(</span>config<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>configuration <span class="token operator">=</span> config<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>

  <span class="token function">readConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> AppConfig <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token keyword">this</span><span class="token punctuation">.</span>configuration
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code>`,mt,A,yn,He,gn,bn,yt,F,En,K,xe,gt,d,_n,Me,An,In,je,Pn,Cn,Re,Tn,Sn,Je,Nn,On,bt,Q,Co=`<code class="language-typescript"><span class="token keyword">const</span> <span class="token function-variable function">appInitializerFn</span> <span class="token operator">=</span> <span class="token punctuation">(</span>configService<span class="token operator">:</span> ConfigService<span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> configService<span class="token punctuation">.</span><span class="token function">setConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token decorator"><span class="token at operator">@</span><span class="token function">NgModule</span></span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  declarations<span class="token operator">:</span> <span class="token punctuation">[</span>AppComponent<span class="token punctuation">]</span><span class="token punctuation">,</span>
  imports<span class="token operator">:</span> <span class="token punctuation">[</span>BrowserModule<span class="token punctuation">,</span> AppRoutingModule<span class="token punctuation">,</span> HttpClientModule<span class="token punctuation">]</span><span class="token punctuation">,</span>
  providers<span class="token operator">:</span> <span class="token punctuation">[</span>
    ConfigService<span class="token punctuation">,</span>
    <span class="token punctuation">&#123;</span>
      provide<span class="token operator">:</span> <span class="token constant">APP_INITIALIZER</span><span class="token punctuation">,</span>
      useFactory<span class="token operator">:</span> appInitializerFn<span class="token punctuation">,</span>
      multi<span class="token operator">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span>
      deps<span class="token operator">:</span> <span class="token punctuation">[</span>ConfigService<span class="token punctuation">]</span><span class="token punctuation">,</span>
    <span class="token punctuation">&#125;</span><span class="token punctuation">,</span>
  <span class="token punctuation">]</span><span class="token punctuation">,</span>
  bootstrap<span class="token operator">:</span> <span class="token punctuation">[</span>AppComponent<span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppModule</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span></code>`,Et,m,Dn,ze,Ln,Wn,Be,Hn,xn,_t,w,Mn,Ze,jn,Rn,Ge,Jn,zn,Ue,Bn,Zn,At,V,To=`<code class="language-typescript"><span class="token decorator"><span class="token at operator">@</span><span class="token function">Component</span></span><span class="token punctuation">(</span><span class="token punctuation">&#123;</span>
  selector<span class="token operator">:</span> <span class="token string">'app-root'</span><span class="token punctuation">,</span>
  templateUrl<span class="token operator">:</span> <span class="token string">'./app.component.html'</span><span class="token punctuation">,</span>
  styleUrls<span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">'./app.component.scss'</span><span class="token punctuation">]</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span><span class="token punctuation">)</span>
<span class="token keyword">export</span> <span class="token keyword">class</span> <span class="token class-name">AppComponent</span> <span class="token keyword">implements</span> <span class="token class-name">OnInit</span> <span class="token punctuation">&#123;</span>
  config<span class="token operator">:</span> AppConfig

  <span class="token function">constructor</span><span class="token punctuation">(</span><span class="token keyword">private</span> configService<span class="token operator">:</span> ConfigService<span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>

  <span class="token function">ngOnInit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> <span class="token keyword">void</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">this</span><span class="token punctuation">.</span>config <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>configService<span class="token punctuation">.</span><span class="token function">readConfig</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></code>`,It,he,Gn,Pt,I,Un,qe,qn,Fn,Ct,X,So='<code class="language-html"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>&#123;&#123; config | json &#125;&#125;<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span></code>',Tt,P,Kn,Y,Qn,Vn,St,$,Xn,ee,Fe,Nt,h,Yn,Ke,$n,ea,te,ta,na,Qe,aa,oa,ne,sa,ia,Ot,C,pa,Ve,la,ra,Dt,ae,ca,oe,Xe,Lt,T,ua,Ye,fa,da,Wt,ke,ha;return{c(){b=a("p"),se=a("img"),$e=u(),E=a("p"),Bt=l("Originally posted on InDepth Dev "),O=a("a"),Zt=l("here"),Gt=l(". Header image by InDepth Dev."),et=u(),ie=a("p"),Ut=l("We’re building an Angular application and when we merge new code into the master branch of our git repo, we want our build tool (like Jenkins) to grab the latest code and build our deployment package for us. With our deployment package built (A.K.A the dist folder), we want to head over to our deployment tool (like Octopus), select an environment to which we want to deploy our app, click a “deploy” button, and trust it to deploy our package, replacing our environment variables in a config file with values specific to the selected environment."),tt=u(),D=a("h2"),qt=l("What We Need to Achieve This"),L=a("a"),me=a("span"),nt=u(),pe=a("p"),Ft=l("We need a configuration file that we can access from our Angular code at runtime — which means it has to exist in the dist folder we intend to deploy. We need it there because we want to configure our deployment tool to replace the values of the environment variables within with values specific to the environment we deploy to."),at=u(),W=a("h2"),Kt=l("Why Angular’s Environment Files Are Not The Solution"),H=a("a"),ye=a("span"),ot=u(),_=a("p"),Qt=l("Let’s say we are using the environment files for our configuration as described "),x=a("a"),Vt=l("here"),Xt=l(". If we run ng build and look inside of the dist folder, we do not see any of the environment files there. Because this is a compile-time solution, the configuration settings in the environment files are pulled into the minified JS bundles in the dist folder. We cannot easily configure our build tool to edit our environment variables if we cannot point it toward a file to edit. In short, this does not work with the “build once, deploy anywhere” model. To do this, our app needs to resolve configuration data at runtime instead of compile time."),st=u(),M=a("h2"),Yt=l("How to Get it Done"),j=a("a"),ge=a("span"),it=u(),le=a("p"),$t=l("Luckily, there is a rather quick solution. All we have to do is:"),pt=u(),k=a("ol"),be=a("li"),Ee=a("p"),en=l("Add a JSON configuration file in the src folder"),tn=u(),_e=a("li"),Ae=a("p"),nn=l("Update our angular/webpack configuration to include the file in our dist folder"),an=u(),Ie=a("li"),Pe=a("p"),on=l("Add a simple configuration service with a call to get our config data from our config file"),sn=u(),Ce=a("li"),Te=a("p"),pn=l("Use APP_INITIALIZER to invoke the method retrieving our config data during the bootstrap process"),lt=u(),re=a("p"),Se=a("strong"),ln=l("Side note: Placing our configuration in a JSON file makes configuring our deployment tool easier because many of them (like Octopus) have native support for replacing values in JSON files."),rt=u(),R=a("h2"),rn=l("Adding the config file"),J=a("a"),Ne=a("span"),ct=u(),ce=a("p"),cn=l("There isn’t much to this step. We’re simply going to add a file named app-config.json and populate it with the following JSON."),ut=u(),z=a("pre"),ft=u(),B=a("h2"),un=l("Ensuring the config file is copied to the dist folder"),Z=a("a"),Oe=a("span"),dt=u(),v=a("p"),fn=l("To achieve this, we need to make an addition to the webpack configuration in the angular.json file. We need to add the path to our config file to the "),De=a("code"),dn=l("assets"),hn=l(" array in the webpack "),Le=a("code"),kn=l("build"),wn=l(" configuration."),ht=u(),ue=a("p"),fe=a("img"),kt=u(),G=a("h2"),vn=l("Building the service"),U=a("a"),We=a("span"),wt=u(),de=a("p"),mn=l("This is a simple service with a private property and two methods — one that sets the property and another that exposes the config data for the rest of your app. We can type the config object with an interface to help ensure we get what we expect from the JSON config file."),vt=u(),q=a("pre"),mt=u(),A=a("p"),yn=l("Notice that the "),He=a("code"),gn=l("setConfigData"),bn=l(" method returns a promise? The initialization of our app will not complete until all promises are resolved so by returning a promise here, we’re ensuring that the config data will be available when the rest of our app loads up and needs to use it."),yt=u(),F=a("h2"),En=l("Let’s take a look"),K=a("a"),xe=a("span"),gt=u(),d=a("p"),_n=l("With that in place, let’s set up the "),Me=a("code"),An=l("APP_INITIALIZER"),In=l(". According to the docs, "),je=a("code"),Pn=l("APP_INITIALIZER"),Cn=l(" is an injection token that allows us to invoke functions during the bootstrapping process of our application. To do that, we add the "),Re=a("code"),Tn=l("ConfigService"),Sn=l(" and "),Je=a("code"),Nn=l("APP_INITIALIZER"),On=l(" token as providers in app.module.ts."),bt=u(),Q=a("pre"),Et=u(),m=a("p"),Dn=l("Note that we need to use a factory function to create an instance of our "),ze=a("code"),Ln=l("ConfigService"),Wn=l(" and call the "),Be=a("code"),Hn=l("setConfig"),xn=l(" method on it."),_t=u(),w=a("p"),Mn=l("Now, to ensure that this worked as expected, we can inject our "),Ze=a("code"),jn=l("ConfigService"),Rn=l(" into the "),Ge=a("code"),Jn=l("AppComponent"),zn=l(" and call our "),Ue=a("code"),Bn=l("readConfig"),Zn=l(" method to get the config object."),At=u(),V=a("pre"),It=u(),he=a("p"),Gn=l("In our app.component.html file, we will just remove all of the default boilerplate HTML and add the following to display our config data."),Pt=u(),I=a("p"),Un=l("If we run our app locally with "),qe=a("code"),qn=l("ng serve"),Fn=l(", we will see our JSON configuration object rendered on the webpage."),Ct=u(),X=a("pre"),Tt=u(),P=a("p"),Kn=l("To see a working example, take a look at the "),Y=a("a"),Qn=l("Github Repo"),Vn=l("."),St=u(),$=a("h2"),Xn=l("Drawbacks to this approach"),ee=a("a"),Fe=a("span"),Nt=u(),h=a("p"),Yn=l("There are a few drawbacks we should be aware of when taking this approach. Because we’re loading our configuration data as a provider in our "),Ke=a("code"),$n=l("AppModule"),ea=l(", we do not have access to it until after our app is bootstrapped. In other words, our configuration data will be there for use in our application as we saw above, but it will not be available if we need it in order to load a module at startup. This is exactly the limitation "),te=a("a"),ta=l("Tim Deschryver"),na=l(" ran into when trying to load an "),Qe=a("code"),aa=l("ApplicationInsightsModule"),oa=l(" at startup that depended on configuration data. If this is your use case, read about how he solved it in his post, "),ne=a("a"),sa=l("Build once deploy to multiple environments"),ia=l("."),Ot=u(),C=a("p"),pa=l("Another potential drawback is that our "),Ve=a("code"),la=l("AppModule"),ra=l(" cannot fully initialize until our configuration service returns a promise containing the configuration data. Depending on how long the network request takes, it could cause a noticeable delay in loading our web app for the end user. If you do not need configuration data during the bootstrapping process and you have a landing page that does not depend on any network calls, you can load configuration data when your landing page initializes to decrease initial load time."),Dt=u(),ae=a("h2"),ca=l("Recap"),oe=a("a"),Xe=a("span"),Lt=u(),T=a("p"),ua=l("To summarize, environment files are great for compile time configuration, but not for the run-time configuration necessary for the “build once, deploy anywhere” CI/CD model. To solve this, we added a JSON config file, ensured that it would be copied into the dist folder, added a service to retrieve the configuration data, and ensured that it would be fetched as our "),Ye=a("code"),fa=l("AppModule"),da=l(" initializes."),Wt=u(),ke=a("p"),ha=l("This approach is easy to implement using what Angular provides out-of-the-box, but (as with anything) we always want to be aware of the drawbacks. The important thing to keep in mind here is that if you need to load a module at startup that depends on configuration data, this approach will not work for you. Happy coding!"),this.h()},l(e){b=o(e,"P",{});var i=s(b);se=o(i,"IMG",{src:!0,alt:!0}),i.forEach(t),$e=f(e),E=o(e,"P",{});var Ht=s(E);Bt=r(Ht,"Originally posted on InDepth Dev "),O=o(Ht,"A",{href:!0,rel:!0});var ma=s(O);Zt=r(ma,"here"),ma.forEach(t),Gt=r(Ht,". Header image by InDepth Dev."),Ht.forEach(t),et=f(e),ie=o(e,"P",{});var ya=s(ie);Ut=r(ya,"We’re building an Angular application and when we merge new code into the master branch of our git repo, we want our build tool (like Jenkins) to grab the latest code and build our deployment package for us. With our deployment package built (A.K.A the dist folder), we want to head over to our deployment tool (like Octopus), select an environment to which we want to deploy our app, click a “deploy” button, and trust it to deploy our package, replacing our environment variables in a config file with values specific to the selected environment."),ya.forEach(t),tt=f(e),D=o(e,"H2",{id:!0});var ga=s(D);qt=r(ga,"What We Need to Achieve This"),ga.forEach(t),L=o(e,"A",{href:!0});var ba=s(L);me=o(ba,"SPAN",{class:!0}),s(me).forEach(t),ba.forEach(t),nt=f(e),pe=o(e,"P",{});var Ea=s(pe);Ft=r(Ea,"We need a configuration file that we can access from our Angular code at runtime — which means it has to exist in the dist folder we intend to deploy. We need it there because we want to configure our deployment tool to replace the values of the environment variables within with values specific to the environment we deploy to."),Ea.forEach(t),at=f(e),W=o(e,"H2",{id:!0});var _a=s(W);Kt=r(_a,"Why Angular’s Environment Files Are Not The Solution"),_a.forEach(t),H=o(e,"A",{href:!0});var Aa=s(H);ye=o(Aa,"SPAN",{class:!0}),s(ye).forEach(t),Aa.forEach(t),ot=f(e),_=o(e,"P",{});var xt=s(_);Qt=r(xt,"Let’s say we are using the environment files for our configuration as described "),x=o(xt,"A",{href:!0,rel:!0});var Ia=s(x);Vt=r(Ia,"here"),Ia.forEach(t),Xt=r(xt,". If we run ng build and look inside of the dist folder, we do not see any of the environment files there. Because this is a compile-time solution, the configuration settings in the environment files are pulled into the minified JS bundles in the dist folder. We cannot easily configure our build tool to edit our environment variables if we cannot point it toward a file to edit. In short, this does not work with the “build once, deploy anywhere” model. To do this, our app needs to resolve configuration data at runtime instead of compile time."),xt.forEach(t),st=f(e),M=o(e,"H2",{id:!0});var Pa=s(M);Yt=r(Pa,"How to Get it Done"),Pa.forEach(t),j=o(e,"A",{href:!0});var Ca=s(j);ge=o(Ca,"SPAN",{class:!0}),s(ge).forEach(t),Ca.forEach(t),it=f(e),le=o(e,"P",{});var Ta=s(le);$t=r(Ta,"Luckily, there is a rather quick solution. All we have to do is:"),Ta.forEach(t),pt=f(e),k=o(e,"OL",{});var S=s(k);be=o(S,"LI",{});var Sa=s(be);Ee=o(Sa,"P",{});var Na=s(Ee);en=r(Na,"Add a JSON configuration file in the src folder"),Na.forEach(t),Sa.forEach(t),tn=f(S),_e=o(S,"LI",{});var Oa=s(_e);Ae=o(Oa,"P",{});var Da=s(Ae);nn=r(Da,"Update our angular/webpack configuration to include the file in our dist folder"),Da.forEach(t),Oa.forEach(t),an=f(S),Ie=o(S,"LI",{});var La=s(Ie);Pe=o(La,"P",{});var Wa=s(Pe);on=r(Wa,"Add a simple configuration service with a call to get our config data from our config file"),Wa.forEach(t),La.forEach(t),sn=f(S),Ce=o(S,"LI",{});var Ha=s(Ce);Te=o(Ha,"P",{});var xa=s(Te);pn=r(xa,"Use APP_INITIALIZER to invoke the method retrieving our config data during the bootstrap process"),xa.forEach(t),Ha.forEach(t),S.forEach(t),lt=f(e),re=o(e,"P",{});var Ma=s(re);Se=o(Ma,"STRONG",{});var ja=s(Se);ln=r(ja,"Side note: Placing our configuration in a JSON file makes configuring our deployment tool easier because many of them (like Octopus) have native support for replacing values in JSON files."),ja.forEach(t),Ma.forEach(t),rt=f(e),R=o(e,"H2",{id:!0});var Ra=s(R);rn=r(Ra,"Adding the config file"),Ra.forEach(t),J=o(e,"A",{href:!0});var Ja=s(J);Ne=o(Ja,"SPAN",{class:!0}),s(Ne).forEach(t),Ja.forEach(t),ct=f(e),ce=o(e,"P",{});var za=s(ce);cn=r(za,"There isn’t much to this step. We’re simply going to add a file named app-config.json and populate it with the following JSON."),za.forEach(t),ut=f(e),z=o(e,"PRE",{class:!0});var No=s(z);No.forEach(t),ft=f(e),B=o(e,"H2",{id:!0});var Ba=s(B);un=r(Ba,"Ensuring the config file is copied to the dist folder"),Ba.forEach(t),Z=o(e,"A",{href:!0});var Za=s(Z);Oe=o(Za,"SPAN",{class:!0}),s(Oe).forEach(t),Za.forEach(t),dt=f(e),v=o(e,"P",{});var we=s(v);fn=r(we,"To achieve this, we need to make an addition to the webpack configuration in the angular.json file. We need to add the path to our config file to the "),De=o(we,"CODE",{});var Ga=s(De);dn=r(Ga,"assets"),Ga.forEach(t),hn=r(we," array in the webpack "),Le=o(we,"CODE",{});var Ua=s(Le);kn=r(Ua,"build"),Ua.forEach(t),wn=r(we," configuration."),we.forEach(t),ht=f(e),ue=o(e,"P",{});var qa=s(ue);fe=o(qa,"IMG",{src:!0,alt:!0}),qa.forEach(t),kt=f(e),G=o(e,"H2",{id:!0});var Fa=s(G);vn=r(Fa,"Building the service"),Fa.forEach(t),U=o(e,"A",{href:!0});var Ka=s(U);We=o(Ka,"SPAN",{class:!0}),s(We).forEach(t),Ka.forEach(t),wt=f(e),de=o(e,"P",{});var Qa=s(de);mn=r(Qa,"This is a simple service with a private property and two methods — one that sets the property and another that exposes the config data for the rest of your app. We can type the config object with an interface to help ensure we get what we expect from the JSON config file."),Qa.forEach(t),vt=f(e),q=o(e,"PRE",{class:!0});var Oo=s(q);Oo.forEach(t),mt=f(e),A=o(e,"P",{});var Mt=s(A);yn=r(Mt,"Notice that the "),He=o(Mt,"CODE",{});var Va=s(He);gn=r(Va,"setConfigData"),Va.forEach(t),bn=r(Mt," method returns a promise? The initialization of our app will not complete until all promises are resolved so by returning a promise here, we’re ensuring that the config data will be available when the rest of our app loads up and needs to use it."),Mt.forEach(t),yt=f(e),F=o(e,"H2",{id:!0});var Xa=s(F);En=r(Xa,"Let’s take a look"),Xa.forEach(t),K=o(e,"A",{href:!0});var Ya=s(K);xe=o(Ya,"SPAN",{class:!0}),s(xe).forEach(t),Ya.forEach(t),gt=f(e),d=o(e,"P",{});var y=s(d);_n=r(y,"With that in place, let’s set up the "),Me=o(y,"CODE",{});var $a=s(Me);An=r($a,"APP_INITIALIZER"),$a.forEach(t),In=r(y,". According to the docs, "),je=o(y,"CODE",{});var eo=s(je);Pn=r(eo,"APP_INITIALIZER"),eo.forEach(t),Cn=r(y," is an injection token that allows us to invoke functions during the bootstrapping process of our application. To do that, we add the "),Re=o(y,"CODE",{});var to=s(Re);Tn=r(to,"ConfigService"),to.forEach(t),Sn=r(y," and "),Je=o(y,"CODE",{});var no=s(Je);Nn=r(no,"APP_INITIALIZER"),no.forEach(t),On=r(y," token as providers in app.module.ts."),y.forEach(t),bt=f(e),Q=o(e,"PRE",{class:!0});var Do=s(Q);Do.forEach(t),Et=f(e),m=o(e,"P",{});var ve=s(m);Dn=r(ve,"Note that we need to use a factory function to create an instance of our "),ze=o(ve,"CODE",{});var ao=s(ze);Ln=r(ao,"ConfigService"),ao.forEach(t),Wn=r(ve," and call the "),Be=o(ve,"CODE",{});var oo=s(Be);Hn=r(oo,"setConfig"),oo.forEach(t),xn=r(ve," method on it."),ve.forEach(t),_t=f(e),w=o(e,"P",{});var N=s(w);Mn=r(N,"Now, to ensure that this worked as expected, we can inject our "),Ze=o(N,"CODE",{});var so=s(Ze);jn=r(so,"ConfigService"),so.forEach(t),Rn=r(N," into the "),Ge=o(N,"CODE",{});var io=s(Ge);Jn=r(io,"AppComponent"),io.forEach(t),zn=r(N," and call our "),Ue=o(N,"CODE",{});var po=s(Ue);Bn=r(po,"readConfig"),po.forEach(t),Zn=r(N," method to get the config object."),N.forEach(t),At=f(e),V=o(e,"PRE",{class:!0});var Lo=s(V);Lo.forEach(t),It=f(e),he=o(e,"P",{});var lo=s(he);Gn=r(lo,"In our app.component.html file, we will just remove all of the default boilerplate HTML and add the following to display our config data."),lo.forEach(t),Pt=f(e),I=o(e,"P",{});var jt=s(I);Un=r(jt,"If we run our app locally with "),qe=o(jt,"CODE",{});var ro=s(qe);qn=r(ro,"ng serve"),ro.forEach(t),Fn=r(jt,", we will see our JSON configuration object rendered on the webpage."),jt.forEach(t),Ct=f(e),X=o(e,"PRE",{class:!0});var Wo=s(X);Wo.forEach(t),Tt=f(e),P=o(e,"P",{});var Rt=s(P);Kn=r(Rt,"To see a working example, take a look at the "),Y=o(Rt,"A",{href:!0,rel:!0});var co=s(Y);Qn=r(co,"Github Repo"),co.forEach(t),Vn=r(Rt,"."),Rt.forEach(t),St=f(e),$=o(e,"H2",{id:!0});var uo=s($);Xn=r(uo,"Drawbacks to this approach"),uo.forEach(t),ee=o(e,"A",{href:!0});var fo=s(ee);Fe=o(fo,"SPAN",{class:!0}),s(Fe).forEach(t),fo.forEach(t),Nt=f(e),h=o(e,"P",{});var g=s(h);Yn=r(g,"There are a few drawbacks we should be aware of when taking this approach. Because we’re loading our configuration data as a provider in our "),Ke=o(g,"CODE",{});var ho=s(Ke);$n=r(ho,"AppModule"),ho.forEach(t),ea=r(g,", we do not have access to it until after our app is bootstrapped. In other words, our configuration data will be there for use in our application as we saw above, but it will not be available if we need it in order to load a module at startup. This is exactly the limitation "),te=o(g,"A",{href:!0,rel:!0});var ko=s(te);ta=r(ko,"Tim Deschryver"),ko.forEach(t),na=r(g," ran into when trying to load an "),Qe=o(g,"CODE",{});var wo=s(Qe);aa=r(wo,"ApplicationInsightsModule"),wo.forEach(t),oa=r(g," at startup that depended on configuration data. If this is your use case, read about how he solved it in his post, "),ne=o(g,"A",{href:!0,rel:!0});var vo=s(ne);sa=r(vo,"Build once deploy to multiple environments"),vo.forEach(t),ia=r(g,"."),g.forEach(t),Ot=f(e),C=o(e,"P",{});var Jt=s(C);pa=r(Jt,"Another potential drawback is that our "),Ve=o(Jt,"CODE",{});var mo=s(Ve);la=r(mo,"AppModule"),mo.forEach(t),ra=r(Jt," cannot fully initialize until our configuration service returns a promise containing the configuration data. Depending on how long the network request takes, it could cause a noticeable delay in loading our web app for the end user. If you do not need configuration data during the bootstrapping process and you have a landing page that does not depend on any network calls, you can load configuration data when your landing page initializes to decrease initial load time."),Jt.forEach(t),Dt=f(e),ae=o(e,"H2",{id:!0});var yo=s(ae);ca=r(yo,"Recap"),yo.forEach(t),oe=o(e,"A",{href:!0});var go=s(oe);Xe=o(go,"SPAN",{class:!0}),s(Xe).forEach(t),go.forEach(t),Lt=f(e),T=o(e,"P",{});var zt=s(T);ua=r(zt,"To summarize, environment files are great for compile time configuration, but not for the run-time configuration necessary for the “build once, deploy anywhere” CI/CD model. To solve this, we added a JSON config file, ensured that it would be copied into the dist folder, added a service to retrieve the configuration data, and ensured that it would be fetched as our "),Ye=o(zt,"CODE",{});var bo=s(Ye);fa=r(bo,"AppModule"),bo.forEach(t),da=r(zt," initializes."),zt.forEach(t),Wt=f(e),ke=o(e,"P",{});var Eo=s(ke);ha=r(Eo,"This approach is easy to implement using what Angular provides out-of-the-box, but (as with anything) we always want to be aware of the drawbacks. The important thing to keep in mind here is that if you need to load a module at startup that depends on configuration data, this approach will not work for you. Happy coding!"),Eo.forEach(t),this.h()},h(){_o(se.src,wa="/static/images/build-once-deploy-anywhere/header-image.webp")||c(se,"src",wa),c(se,"alt","Worker with Toolbox"),c(O,"href","https://indepth.dev/posts/1338/build-your-angular-app-once-deploy-anywhere"),c(O,"rel","nofollow"),c(D,"id","what-we-need-to-achieve-this"),c(me,"class","icon icon-link"),c(L,"href","#what-we-need-to-achieve-this"),c(W,"id","why-angulars-environment-files-are-not-the-solution"),c(ye,"class","icon icon-link"),c(H,"href","#why-angulars-environment-files-are-not-the-solution"),c(x,"href","https://angular.io/guide/build"),c(x,"rel","nofollow"),c(M,"id","how-to-get-it-done"),c(ge,"class","icon icon-link"),c(j,"href","#how-to-get-it-done"),c(R,"id","adding-the-config-file"),c(Ne,"class","icon icon-link"),c(J,"href","#adding-the-config-file"),c(z,"class","language-typescript"),c(B,"id","ensuring-the-config-file-is-copied-to-the-dist-folder"),c(Oe,"class","icon icon-link"),c(Z,"href","#ensuring-the-config-file-is-copied-to-the-dist-folder"),_o(fe.src,va="/static/images/build-once-deploy-anywhere/angularjson.png")||c(fe,"src",va),c(fe,"alt","angular.json"),c(G,"id","building-the-service"),c(We,"class","icon icon-link"),c(U,"href","#building-the-service"),c(q,"class","language-typescript"),c(F,"id","lets-take-a-look"),c(xe,"class","icon icon-link"),c(K,"href","#lets-take-a-look"),c(Q,"class","language-typescript"),c(V,"class","language-typescript"),c(X,"class","language-html"),c(Y,"href","https://github.com/KylerJohnsonDev/ng-runtime-config"),c(Y,"rel","nofollow"),c($,"id","drawbacks-to-this-approach"),c(Fe,"class","icon icon-link"),c(ee,"href","#drawbacks-to-this-approach"),c(te,"href","https://indepth.dev/authors/1010/timdeschryver"),c(te,"rel","nofollow"),c(ne,"href","https://admin.indepth.dev/build-once-deploy-to-multiple-environments/"),c(ne,"rel","nofollow"),c(ae,"id","recap"),c(Xe,"class","icon icon-link"),c(oe,"href","#recap")},m(e,i){p(e,b,i),n(b,se),p(e,$e,i),p(e,E,i),n(E,Bt),n(E,O),n(O,Zt),n(E,Gt),p(e,et,i),p(e,ie,i),n(ie,Ut),p(e,tt,i),p(e,D,i),n(D,qt),p(e,L,i),n(L,me),p(e,nt,i),p(e,pe,i),n(pe,Ft),p(e,at,i),p(e,W,i),n(W,Kt),p(e,H,i),n(H,ye),p(e,ot,i),p(e,_,i),n(_,Qt),n(_,x),n(x,Vt),n(_,Xt),p(e,st,i),p(e,M,i),n(M,Yt),p(e,j,i),n(j,ge),p(e,it,i),p(e,le,i),n(le,$t),p(e,pt,i),p(e,k,i),n(k,be),n(be,Ee),n(Ee,en),n(k,tn),n(k,_e),n(_e,Ae),n(Ae,nn),n(k,an),n(k,Ie),n(Ie,Pe),n(Pe,on),n(k,sn),n(k,Ce),n(Ce,Te),n(Te,pn),p(e,lt,i),p(e,re,i),n(re,Se),n(Se,ln),p(e,rt,i),p(e,R,i),n(R,rn),p(e,J,i),n(J,Ne),p(e,ct,i),p(e,ce,i),n(ce,cn),p(e,ut,i),p(e,z,i),z.innerHTML=Io,p(e,ft,i),p(e,B,i),n(B,un),p(e,Z,i),n(Z,Oe),p(e,dt,i),p(e,v,i),n(v,fn),n(v,De),n(De,dn),n(v,hn),n(v,Le),n(Le,kn),n(v,wn),p(e,ht,i),p(e,ue,i),n(ue,fe),p(e,kt,i),p(e,G,i),n(G,vn),p(e,U,i),n(U,We),p(e,wt,i),p(e,de,i),n(de,mn),p(e,vt,i),p(e,q,i),q.innerHTML=Po,p(e,mt,i),p(e,A,i),n(A,yn),n(A,He),n(He,gn),n(A,bn),p(e,yt,i),p(e,F,i),n(F,En),p(e,K,i),n(K,xe),p(e,gt,i),p(e,d,i),n(d,_n),n(d,Me),n(Me,An),n(d,In),n(d,je),n(je,Pn),n(d,Cn),n(d,Re),n(Re,Tn),n(d,Sn),n(d,Je),n(Je,Nn),n(d,On),p(e,bt,i),p(e,Q,i),Q.innerHTML=Co,p(e,Et,i),p(e,m,i),n(m,Dn),n(m,ze),n(ze,Ln),n(m,Wn),n(m,Be),n(Be,Hn),n(m,xn),p(e,_t,i),p(e,w,i),n(w,Mn),n(w,Ze),n(Ze,jn),n(w,Rn),n(w,Ge),n(Ge,Jn),n(w,zn),n(w,Ue),n(Ue,Bn),n(w,Zn),p(e,At,i),p(e,V,i),V.innerHTML=To,p(e,It,i),p(e,he,i),n(he,Gn),p(e,Pt,i),p(e,I,i),n(I,Un),n(I,qe),n(qe,qn),n(I,Fn),p(e,Ct,i),p(e,X,i),X.innerHTML=So,p(e,Tt,i),p(e,P,i),n(P,Kn),n(P,Y),n(Y,Qn),n(P,Vn),p(e,St,i),p(e,$,i),n($,Xn),p(e,ee,i),n(ee,Fe),p(e,Nt,i),p(e,h,i),n(h,Yn),n(h,Ke),n(Ke,$n),n(h,ea),n(h,te),n(te,ta),n(h,na),n(h,Qe),n(Qe,aa),n(h,oa),n(h,ne),n(ne,sa),n(h,ia),p(e,Ot,i),p(e,C,i),n(C,pa),n(C,Ve),n(Ve,la),n(C,ra),p(e,Dt,i),p(e,ae,i),n(ae,ca),p(e,oe,i),n(oe,Xe),p(e,Lt,i),p(e,T,i),n(T,ua),n(T,Ye),n(Ye,fa),n(T,da),p(e,Wt,i),p(e,ke,i),n(ke,ha)},p:ka,i:ka,o:ka,d(e){e&&t(b),e&&t($e),e&&t(E),e&&t(et),e&&t(ie),e&&t(tt),e&&t(D),e&&t(L),e&&t(nt),e&&t(pe),e&&t(at),e&&t(W),e&&t(H),e&&t(ot),e&&t(_),e&&t(st),e&&t(M),e&&t(j),e&&t(it),e&&t(le),e&&t(pt),e&&t(k),e&&t(lt),e&&t(re),e&&t(rt),e&&t(R),e&&t(J),e&&t(ct),e&&t(ce),e&&t(ut),e&&t(z),e&&t(ft),e&&t(B),e&&t(Z),e&&t(dt),e&&t(v),e&&t(ht),e&&t(ue),e&&t(kt),e&&t(G),e&&t(U),e&&t(wt),e&&t(de),e&&t(vt),e&&t(q),e&&t(mt),e&&t(A),e&&t(yt),e&&t(F),e&&t(K),e&&t(gt),e&&t(d),e&&t(bt),e&&t(Q),e&&t(Et),e&&t(m),e&&t(_t),e&&t(w),e&&t(At),e&&t(V),e&&t(It),e&&t(he),e&&t(Pt),e&&t(I),e&&t(Ct),e&&t(X),e&&t(Tt),e&&t(P),e&&t(St),e&&t($),e&&t(ee),e&&t(Nt),e&&t(h),e&&t(Ot),e&&t(C),e&&t(Dt),e&&t(ae),e&&t(oe),e&&t(Lt),e&&t(T),e&&t(Wt),e&&t(ke)}}}const Jo={title:"Build your Angular App Once, Deploy Anywhere",date:"2020-09-17",description:"Want to build your Angular app once and deploy anywhere? Learn why compile-time configuration isn't enough and how we can load configuration at run-time.",published:!0,tags:["Angular"],canonicalUrl:"https://indepth.dev/posts/1338/build-your-angular-app-once-deploy-anywhere"};class zo extends Ho{constructor(b){super(),xo(this,b,null,jo,Mo,{})}}export{zo as default,Jo as metadata};
